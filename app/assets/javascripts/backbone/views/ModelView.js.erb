App.Views.LocationView = Backbone.View.extend({
  tagName: 'div',
  className: 'location showInventory',
  events:{
    'click .showInventory': 'grabListInventory',
    'click .create': 'createBranch'
  },
  initialize:function(){
    console.log("One VIew Created");
    this.locationTemplate = HandlebarsTemplates['location'];
    this.newBranchTemplate = HandlebarsTemplates['newBranch'];
    this.newBranch();
  },
  render: function(){
    this.$el.html(this.locationTemplate(this.model.toJSON()));
  },
  newBranch:function(){
    console.log("new Branch template ")
    var newBranch = this.$el.prepend(this.newBranchTemplate(this.model.toJSON()));
    $("#new-branch").append(newBranch);
  },
  createBranch:function(){
    var createObject = {};

    createObject.name = $('input#Name').val();
    createObject.address = $('input#Address').val();
    createObject.city = $('input#City').val();
    createObject.state = $('input#State').val();
    createObject.zip = $('input#Zip').val();
    createObject.headquarter_id = parseInt($('div').attr("id"));
    App.locationCollection.create(createObject);

    $('input#Name').val('');
    $('input#Address').val('');
    $('input#City').val('');
    $('input#State').val('');
    $('input#Zip').val('');
  },
  grabListInventory:function(){
    $('#inventory-list').empty();
    var headquarter_id = this.model.attributes.headquarter_id;
    App.InventoriesCollection = new App.Collections.InventoriesCollection({branch_id: headquarter_id});
    App.InventoriesCollection.fetchInventory({success: this.renderListInventory});
  },
  renderListInventory:function(collection){
    this.inventoryListView = new App.Views.InventoryListView({collection: collection});
    this.inventoryListView.render();
  },


});
